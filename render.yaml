staticSites:
  - name: ag116-frontend
    env: node
    root: .
    installCommand: |
      echo "=== CLEANUP BEFORE INSTALL ==="
      rm -rf node_modules package-lock.json package-lock.* yarn.lock frontend/node_modules || true
      echo "=== NPM CACHE CLEAN ==="
      npm cache clean --force || true
      echo "=== NPM INSTALL (legacy peer deps) ==="
      npm install --legacy-peer-deps
    buildCommand: |
      echo "=== NODE & NPM ==="
      node -v && npm -v
      echo "=== NPX EXPO VERSION ==="
      npx expo --version || true
      echo "=== RUN EXPO EXPORT (capture output) ==="
      npx expo export:web --no-interactive --output-dir web-build 2>&1 | sed -n '1,400p' || true
      echo "=== LS ROOT ==="
      ls -la
      echo "=== FIND web-build ==="
      find . -maxdepth 4 -type d -iname "web-build" -o -iname "web" -o -iname "dist" -o -iname "build" -print -quit
    publishPath: web-build
